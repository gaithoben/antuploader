{"version":3,"sources":["../src/Utils.js"],"names":["T","fileToObject","file","lastModified","lastModifiedDate","name","size","type","uid","percent","originFileObj","genPercentAdd","k","i","end","s","start","getFileItem","fileList","matchKey","undefined","filter","item","removeFileItem","removed","length","extname","url","temp","split","filename","filenameWithoutSuffix","exec","isImageFileType","indexOf","isImageUrl","thumbUrl","extension","test","MEASURE_SIZE","previewImage","Promise","resolve","canvas","document","createElement","width","height","style","cssText","body","appendChild","ctx","getContext","img","Image","onload","drawWidth","drawHeight","offsetX","offsetY","drawImage","dataURL","toDataURL","removeChild","src","window","URL","createObjectURL"],"mappings":"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","sourcesContent":["export function T() {\n  return true;\n}\n\n// Fix IE file.status problem\n// via coping a new Object\nexport function fileToObject(file) {\n  return {\n    ...file,\n    lastModified: file.lastModified,\n    lastModifiedDate: file.lastModifiedDate,\n    name: file.name,\n    size: file.size,\n    type: file.type,\n    uid: file.uid,\n    percent: 0,\n    originFileObj: file,\n  };\n}\n\n/**\n * 生成Progress percent: 0.1 -> 0.98\n *   - for ie\n */\nexport function genPercentAdd() {\n  let k = 0.1;\n  const i = 0.01;\n  const end = 0.98;\n  return function(s) {\n    let start = s;\n    if (start >= end) {\n      return start;\n    }\n\n    start += k;\n    k = k - i;\n    if (k < 0.001) {\n      k = 0.001;\n    }\n    return start;\n  };\n}\n\nexport function getFileItem(file, fileList) {\n  const matchKey = file.uid !== undefined ? 'uid' : 'name';\n  return fileList.filter(item => item[matchKey] === file[matchKey])[0];\n}\n\nexport function removeFileItem(file, fileList) {\n  const matchKey = file.uid !== undefined ? 'uid' : 'name';\n  const removed = fileList.filter(item => item[matchKey] !== file[matchKey]);\n  if (removed.length === fileList.length) {\n    return null;\n  }\n  return removed;\n}\n\n// ==================== Default Image Preview ====================\nconst extname = url => {\n  if (!url) {\n    return '';\n  }\n  const temp = url.split('/');\n  const filename = temp[temp.length - 1];\n  const filenameWithoutSuffix = filename.split(/#|\\?/)[0];\n  return (/\\.[^./\\\\]*$/.exec(filenameWithoutSuffix) || [''])[0];\n};\nconst isImageFileType = (type): boolean => !!type && type.indexOf('image/') === 0;\nexport const isImageUrl = (file: UploadFile): boolean => {\n  if (isImageFileType(file.type)) {\n    return true;\n  }\n  const url = file.thumbUrl || file.url;\n  const extension = extname(url);\n  if (/^data:image\\//.test(url) || /(webp|svg|png|gif|jpg|jpeg|bmp|dpg)$/i.test(extension)) {\n    return true;\n  } else if (/^data:/.test(url)) {\n    // other file types of base64\n    return false;\n  } else if (extension) {\n    // other file types which have extension\n    return false;\n  }\n  return true;\n};\n\nconst MEASURE_SIZE = 200;\nexport function previewImage(file) {\n  return new Promise(resolve => {\n    if (!isImageFileType(file.type)) {\n      resolve('');\n      return;\n    }\n\n    const canvas = document.createElement('canvas');\n    canvas.width = MEASURE_SIZE;\n    canvas.height = MEASURE_SIZE;\n    canvas.style.cssText = `position: fixed; left: 0; top: 0; width: ${MEASURE_SIZE}px; height: ${MEASURE_SIZE}px; z-index: 9999; display: none;`;\n    document.body.appendChild(canvas);\n    const ctx = canvas.getContext('2d');\n    const img = new Image();\n    img.onload = function() {\n      const { width, height } = img;\n\n      let drawWidth = MEASURE_SIZE;\n      let drawHeight = MEASURE_SIZE;\n      let offsetX = 0;\n      let offsetY = 0;\n\n      if (width < height) {\n        drawHeight = height * (MEASURE_SIZE / width);\n        offsetY = -(drawHeight - drawWidth) / 2;\n      } else {\n        drawWidth = width * (MEASURE_SIZE / height);\n        offsetX = -(drawWidth - drawHeight) / 2;\n      }\n\n      ctx.drawImage(img, offsetX, offsetY, drawWidth, drawHeight);\n      const dataURL = canvas.toDataURL();\n      document.body.removeChild(canvas);\n\n      resolve(dataURL);\n    };\n    img.src = window.URL.createObjectURL(file);\n  });\n}\n"],"file":"Utils.js"}